(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{107:function(e,n,t){"use strict";t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return b}));var o=t(0),i=t.n(o);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,i=function(e,n){if(null==e)return{};var t,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var p=i.a.createContext({}),l=function(e){var n=i.a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},d=function(e){var n=l(e.components);return i.a.createElement(p.Provider,{value:n},e.children)},h={inlineCode:"code",wrapper:function(e){var n=e.children;return i.a.createElement(i.a.Fragment,{},n)}},m=i.a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=l(t),m=o,b=d["".concat(c,".").concat(m)]||d[m]||h[m]||a;return t?i.a.createElement(b,r(r({ref:n},p),{},{components:t})):i.a.createElement(b,r({ref:n},p))}));function b(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,c=new Array(a);c[0]=m;var r={};for(var s in n)hasOwnProperty.call(n,s)&&(r[s]=n[s]);r.originalType=e,r.mdxType="string"==typeof e?e:o,c[1]=r;for(var p=2;p<a;p++)c[p]=t[p];return i.a.createElement.apply(null,c)}return i.a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},84:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return c})),t.d(n,"metadata",(function(){return r})),t.d(n,"toc",(function(){return s})),t.d(n,"default",(function(){return l}));var o=t(3),i=t(7),a=(t(0),t(107)),c={slug:"wifi-provision",title:"Wifi Provision",author:"Hacker 6009",author_title:"Blog Admin",author_url:null,author_image_url:"/img/falundafa_avatar.jpg",tags:["sysadmin"]},r={permalink:"/blog/wifi-provision",editUrl:"https://github.com/khoahoc/blog/edit/master/blog/2021-03-08-wifi-provision.md",source:"@site/blog/2021-03-08-wifi-provision.md",description:"Wifi Provision",date:"2021-03-08T00:00:00.000Z",tags:[{label:"sysadmin",permalink:"/blog/tags/sysadmin"}],title:"Wifi Provision",readingTime:14.51,truncated:!0,prevItem:{title:"System Architect",permalink:"/blog/system-architect"},nextItem:{title:"OpenNDS Ho\u1ea1t \u0110\u1ed9ng Nh\u01b0 Th\u1ebf N\xe0o",permalink:"/blog/opennds-hoat-dong-nhu-the-nao"}},s=[{value:"PH\u1ea6N SETUP SERVER",id:"ph\u1ea7n-setup-server",children:[{value:"Setup SSH Tunnel",id:"setup-ssh-tunnel",children:[]},{value:"Setup Nginx",id:"setup-nginx",children:[]},{value:"OpenSSH Config",id:"openssh-config",children:[]},{value:"Setup Prometheus",id:"setup-prometheus",children:[]}]},{value:"PH\u1ea6N SETUP ACCESS POINT",id:"ph\u1ea7n-setup-access-point",children:[{value:"Setup Private Key",id:"setup-private-key",children:[]},{value:"Setup Authorized Key",id:"setup-authorized-key",children:[]},{value:"C\xe0i \u0110\u1eb7t C\xe1c G\xf3i",id:"c\xe0i-\u0111\u1eb7t-c\xe1c-g\xf3i",children:[]},{value:"Config TTYD",id:"config-ttyd",children:[]},{value:"Config AutoSSH",id:"config-autossh",children:[]},{value:"Prometheus Lua",id:"prometheus-lua",children:[]}]},{value:"ACCESS POINT SETTINGS",id:"access-point-settings",children:[{value:"Setting S\xf3ng Wifi",id:"setting-s\xf3ng-wifi",children:[]},{value:"Setting Captive Portal",id:"setting-captive-portal",children:[]}]},{value:"Access Point Advanced Setting",id:"access-point-advanced-setting",children:[{value:"Network Config",id:"network-config",children:[]}]},{value:"ACCESS POINT MANAGEMENT",id:"access-point-management",children:[{value:"\u0110i\u1ec1u Khi\u1ec3n",id:"\u0111i\u1ec1u-khi\u1ec3n",children:[]},{value:"Gi\xe1m S\xe1t",id:"gi\xe1m-s\xe1t",children:[]},{value:"\u0110\u1ebfm Session",id:"\u0111\u1ebfm-session",children:[]},{value:"Xem Th\xf4ng Tin Thi\u1ebft B\u1ecb",id:"xem-th\xf4ng-tin-thi\u1ebft-b\u1ecb",children:[]}]},{value:"PROVISION SCRIPT",id:"provision-script",children:[{value:"Setup Command",id:"setup-command",children:[]},{value:"Github Repository",id:"github-repository",children:[]}]}],p={toc:s};function l(e){var n=e.components,t=Object(i.a)(e,["components"]);return Object(a.b)("wrapper",Object(o.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("h1",{id:"wifi-provision"},"Wifi Provision"),Object(a.b)("p",null,"\u0110\xe2y l\xe0 t\xe0i li\u1ec7u document ch\xednh h\u01b0\u1edbng d\u1eabn manual setup to\xe0n b\u1ed9 technical architect gi\u1eefa c\xe1c Access Point v\xe0 Server Prometheus d\u01b0\u1ee3c d\xe0n d\u1ef1ng b\u1edfi ",Object(a.b)("inlineCode",{parentName:"p"},"sudosys.com"),"."),Object(a.b)("div",{className:"admonition admonition-info alert alert--info"},Object(a.b)("div",{parentName:"div",className:"admonition-heading"},Object(a.b)("h5",{parentName:"div"},Object(a.b)("span",{parentName:"h5",className:"admonition-icon"},Object(a.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(a.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),Object(a.b)("div",{parentName:"div",className:"admonition-content"},Object(a.b)("ol",{parentName:"div"},Object(a.b)("li",{parentName:"ol"},"T\xe0i li\u1ec7u kh\xf4ng ph\xf9 h\u1ee3p v\u1edbi ng\u01b0\u1eddi ch\u01b0a c\xf3 \u0111\u1ecbnh ngh\u0129a v\u1ec1 c\xe1c d\u1ecbch v\u1ee5 (services)."),Object(a.b)("li",{parentName:"ol"},"Ph\xeda d\u01b0\u1edbi l\xe0 qu\xe1 tr\xecnh setup k\u1ef9 thu\u1eadt. \u0110\u1ecbnh ngh\u0129a c\u1ee7a service cho bi\u1ebft m\u1ee5c ti\xeau c\u1ee7a t\xe1c gi\u1ea3 \u0111ang th\u1ef1c hi\u1ec7n.")))),Object(a.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(a.b)("div",{parentName:"div",className:"admonition-heading"},Object(a.b)("h5",{parentName:"div"},Object(a.b)("span",{parentName:"h5",className:"admonition-icon"},Object(a.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(a.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(a.b)("div",{parentName:"div",className:"admonition-content"},Object(a.b)("p",{parentName:"div"},"Do tr\xecnh \u0111\u1ed9 k\u1ef9 thu\u1eadt h\u1ea1n h\u1eb9p, mong c\xe1c b\u1ea1n \u0111\u1ecdc gi\u1ea3 c\xf3 th\u1ec3 g\xf3p \xfd ho\u1eb7c \u0111\u1eb7t c\xe2u h\u1ecfi th\xf4ng qua ph\u1ea7n ",Object(a.b)("inlineCode",{parentName:"p"},"Li\xean H\u1ec7")," \u1edf tr\xean."))),Object(a.b)("h2",{id:"ph\u1ea7n-setup-server"},"PH\u1ea6N SETUP SERVER"),Object(a.b)("h3",{id:"setup-ssh-tunnel"},"Setup SSH Tunnel"),Object(a.b)("h4",{id:"th\xeam-t\xe0i-kho\u1ea3n-truy-c\u1eadp-server"},"Th\xeam t\xe0i kho\u1ea3n truy c\u1eadp server"),Object(a.b)("p",null,"Th\xeam user ",Object(a.b)("inlineCode",{parentName:"p"},"noaccess")," \u0111\u1ec3 c\xe1c Access Point c\xf3 th\u1ec3 SSH v\xe0o nh\u01b0ng ",Object(a.b)("inlineCode",{parentName:"p"},"kh\xf4ng c\xf3 quy\u1ec1n")," g\xf5 l\u1ec7nh terminal:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"sudo adduser --disabled-password --shell /sbin/nologin noaccess\nsudo  -u noaccess whoami\nsudo  -u noaccess ssh-keygen #T\u1ea1o folder v\xe0 chmod cho l\u1eb9\nsudo touch /home/noaccess/.ssh/authorized_keys\nsudo chmod 600 /home/noaccess/.ssh/authorized_keys\n")),Object(a.b)("h3",{id:"setup-nginx"},"Setup Nginx"),Object(a.b)("p",null,"Nginx g\u1ed3m 2 ch\u1ee9c n\u0103ng:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"Ph\xe2n gi\u1ea3i t\xean mi\u1ec1n v\xe0o h\xe0ng lo\u1ea1t IP kh\xe1c nhau c\xf3 c\xf9ng 1 TCP port TTYD c\u1ee7a Access Point"),Object(a.b)("li",{parentName:"ol"},"X\xe1c th\u1ef1c ng\u01b0\u1eddi d\xf9ng qua URL token ho\u1eb7c username v\xe0 password.")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'server {\n        server_name ssh.aps.ip1.meganet.com.vn;\n\n        location ^~ / {\n            resolver 8.8.8.8;\n            proxy_set_header Host $host;\n            proxy_set_header X-Forwarded-Proto $scheme;\n            proxy_set_header X-Forwarded-Port $server_port;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection "upgrade";\n\n            location ~ "^/(.*)/(.*)/(.*)/(.*)" {\n                auth_request /auth;\n                auth_request_set $auth_status $upstream_status;\n                proxy_pass http://$3:7681/$4;\n            }\n        }\n\n        location = /auth {\n                internal;\n                #proxy_pass http://127.0.0.1:8080/tms/aps/authorized;\n                proxy_pass https://demo.meganet.com.vn/api/Prometheus/authorized;\n                proxy_pass_request_body off;\n                proxy_set_header Content-Length "";\n                proxy_set_header X-Original-URI $request_uri;\n        }\n\n    listen 443 ssl http2; # managed by Certbot\n\n    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot\n\n\n\n    ssl_certificate /etc/letsencrypt/live/ssh.aps.ip1.meganet.com.vn/fullchain.pem; # managed by Certbot\n    ssl_certificate_key /etc/letsencrypt/live/ssh.aps.ip1.meganet.com.vn/privkey.pem; # managed by Certbot\n}\n\nserver {\n    if ($host = ssh.aps.ip1.meganet.com.vn) {\n        return 301 https://$host$request_uri;\n    } # managed by Certbot\n\n        listen 80;\n        listen [::]:80;\n\n        server_name ssh.aps.ip1.meganet.com.vn;\n    return 404; # managed by Certbot\n\n\n}\n')),Object(a.b)("h3",{id:"openssh-config"},"OpenSSH Config"),Object(a.b)("p",null,"L\u01b0u \xfd c\xe1c tr\u01b0\u1eddng sau trong file ",Object(a.b)("inlineCode",{parentName:"p"},"/etc/ssh/sshd_config"),":"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"IgnoreUserKnownHosts yes\nAllowAgentForwarding yes\nAllowTcpForwarding yes\nX11Forwarding yes\nPermitTunnel yes\nTCPKeepAlive yes\nPermitTTY yes\nGatewayPorts clientspecified\n")),Object(a.b)("p",null,"C\u1ea5u h\xecnh xong nh\u1edb restart service:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"sudo systemctl restart ssh\n")),Object(a.b)("h3",{id:"setup-prometheus"},"Setup Prometheus"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"global:\n  scrape_interval: 15s\n  scrape_timeout: 10s\n  evaluation_interval: 15s\nalerting:\n  alertmanagers:\n    - scheme: http\n      timeout: 10s\n      api_version: v1\n      static_configs:\n        - targets:\n            - localhost:9093\nrule_files:\n  - server_rules.yml\n  - aps_rules.yml\nscrape_configs:\n  - job_name: prometheus\n    honor_timestamps: true\n    scrape_interval: 15s\n    scrape_timeout: 10s\n    metrics_path: /metrics\n    scheme: http\n    static_configs:\n      - targets:\n          - localhost:9090\n  - job_name: Wifi Export - Nha Hoc\n    honor_timestamps: true\n    scrape_interval: 15s\n    scrape_timeout: 10s\n    metrics_path: /metrics\n    scheme: http\n    static_configs:\n      - targets:\n          - undefined:9100\n        labels:\n          group: demo\n          locationId: 5d67aad0c757097414ff3dc0\n          city: thanh-pho-ho-chi-minh\n          district: Qu\u1eadn T\xe2n B\xecnh\n          type: devices\n  - job_name: Wifi Export - Thai Hoang\n    honor_timestamps: true\n    scrape_interval: 15s\n    scrape_timeout: 10s\n    metrics_path: /metrics\n    scheme: http\n    static_configs:\n      - targets:\n          - undefined:9100\n          - 127.1.23.128:9100\n        labels:\n          group: demo\n          locationId: 5d6f6963439a91549c125bae\n          city: thanh-pho-ho-chi-minh\n          district: Qu\u1eadn 10\n          type: devices\n  - job_name: Wifi Export - MegaNet Office\n    honor_timestamps: true\n    scrape_interval: 15s\n    scrape_timeout: 10s\n    metrics_path: /metrics\n    scheme: http\n    static_configs:\n      - targets:\n          - 127.1.8.103:9100\n          - 127.1.6.134:9100\n          - 127.1.4.153:9100\n          - 127.1.9.124:9100\n          - 127.1.8.242:9100\n          - 127.1.4.193:9100\n          - 127.1.23.117:9100\n          - 127.1.2.172:9100\n          - 127.1.4.194:9100\n          - 127.1.4.198:9100\n          - 127.1.5.137:9100\n          - 127.1.5.122:9100\n          - 127.1.23.121:9100\n          - 127.1.23.122:9100\n          - 127.1.7.40:9100\n          - 127.1.23.125:9100\n        labels:\n          group: demo\n          locationId: 5ff5402d2cc39f45cf013780\n          city: thanh-pho-ho-chi-minh\n          district: Qu\u1eadn 10\n          type: devices\n  - job_name: Wifi Export - Go Dau\n    honor_timestamps: true\n    scrape_interval: 15s\n    scrape_timeout: 10s\n    metrics_path: /metrics\n    scheme: http\n    static_configs:\n      - targets:\n          - 127.1.9.3:9100\n          - 127.1.23.119:9100\n          - 127.1.23.120:9100\n          - 127.1.23.123:9100\n          - 127.1.23.124:9100\n        labels:\n          group: demo\n          locationId: 5fffc4141c6aca3a34078928\n          city: thanh-pho-ho-chi-minh\n          district: Qu\u1eadn T\xe2n Ph\xfa\n          type: devices\n  - job_name: Wifi Export - CF Viva Hoang Hoa Tham\n    honor_timestamps: true\n    scrape_interval: 15s\n    scrape_timeout: 10s\n    metrics_path: /metrics\n    scheme: http\n    static_configs:\n      - targets:\n          - 127.1.23.118:9100\n        labels:\n          group: demo\n          locationId: 5ff5921cfe51dd2f2088d13f\n          city: thanh-pho-ho-chi-minh\n          district: Qu\u1eadn T\xe2n B\xecnh\n          type: devices\n  - job_name: Wifi Export - CF Kim\n    honor_timestamps: true\n    scrape_interval: 15s\n    scrape_timeout: 10s\n    metrics_path: /metrics\n    scheme: http\n    static_configs:\n      - targets:\n          - 127.1.23.126:9100\n          - 127.1.23.127:9100\n        labels:\n          group: demo\n          locationId: 60113cc61d43d20f04895bc2\n          city: thanh-pho-ho-chi-minh\n          district: Qu\u1eadn 7\n          type: devices\n")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Theo quy t\u1eafc IP ",Object(a.b)("inlineCode",{parentName:"li"},"127.1.0.1")," t\u01b0\u01a1ng \u1ee9ng v\u1edbi Access Point c\xf3 ID l\xe0 ",Object(a.b)("inlineCode",{parentName:"li"},"1")," v\xe0 t\u0103ng d\u1ea7n l\xean."),Object(a.b)("li",{parentName:"ul"},"Port 9100 l\xe0 port m\u1eb7c \u0111\u1ecbnh c\u1ee7a ",Object(a.b)("inlineCode",{parentName:"li"},"Node Exporter Prometheus Lua"),".")),Object(a.b)("h2",{id:"ph\u1ea7n-setup-access-point"},"PH\u1ea6N SETUP ACCESS POINT"),Object(a.b)("p",null,"C\xf3 r\u1ea5t nhi\u1ec1u th\u1ee9 c\u1ea7n ph\u1ea3i setup nh\u01b0: c\u1eb7p SSH ",Object(a.b)("inlineCode",{parentName:"p"},"public_key")," v\xe0 ",Object(a.b)("inlineCode",{parentName:"p"},"private key"),"; C\xe1c packages c\u1ee7a OpenWRT \u0111\u1ec3 \u0111i\u1ec1u khi\u1ec3n nh\u01b0: ",Object(a.b)("inlineCode",{parentName:"p"},"Prometheus"),", ",Object(a.b)("inlineCode",{parentName:"p"},"Node Exporter"),", ",Object(a.b)("inlineCode",{parentName:"p"},"Wifi Station"),"; ",Object(a.b)("inlineCode",{parentName:"p"},"AutoSSH"),"; ",Object(a.b)("inlineCode",{parentName:"p"},"TTYD"),", ",Object(a.b)("inlineCode",{parentName:"p"},"OpenNDS")," v.v... OK, b\u1eaft \u0111\u1ea7u th\xf4i."),Object(a.b)("h3",{id:"setup-private-key"},"Setup Private Key"),Object(a.b)("p",null,Object(a.b)("em",{parentName:"p"},"K\u1ebft qu\u1ea3 b\xean d\u01b0\u1edbi s\u1ebd \xe1p d\u1ee5ng cho production, n\xean l\u01b0u \xfd d\u1eef li\u1ec7u c\u1ee7a c\u1eb7p key b\xean d\u01b0\u1edbi")),Object(a.b)("p",null,"Public_key:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC8x4yIvN1KHioqqi9JahUgZN9Cb3sXpCmpv8BiZXt6GPuJE0wwvFo8j+c8lxm8Yv/unhLy8PyQiSMPwchSCAg2b02D1IVh8WUbXIkOqdNDF5aQx02dPfaE9XRJqc3H85L7h5jNHie/Ax6uthPcI+F8dD8kZRJOj3snev36S97Q3G9qawWqhvGyv2COcbmYKA+dAM1MSa1GHidMCPIkuZmjcA6i4wuH1Rc13ke/jmyTFFEm4Xf2S4bHL9gpFOkHCN0u6XTwn6VGZus2tKsB5l4Cx0xr5MCGGSnSKSDFUHagWgJ+5GUWFMJ9y77qK1Ig7kbAuDFeH+4m49ODZCrfmWzB wifi_devices\n")),Object(a.b)("p",null,"Private_key:"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"-----BEGIN RSA PRIVATE KEY-----\nMIIEogIBAAKCAQEAvMeMiLzdSh4qKqovSWoVIGTfQm97F6Qpqb/AYmV7ehj7iRNM\nMLxaPI/nPJcZvGL/7p4S8vD8kIkjD8HIUggINm9Ng9SFYfFlG1yJDqnTQxeWkMdN\nnT32hPV0SanNx/OS+4eYzR4nvwMerrYT3CPhfHQ/JGUSTo97J3r9+kve0NxvamsF\nqobxsr9gjnG5mCgPnQDNTEmtRh4nTAjyJLmZo3AOouMLh9UXNd5Hv45skxRRJuF3\n9kuGxy/YKRTpBwjdLul08J+lRmbrNrSrAeZeAsdMa+TAhhkp0ikgxVB2oFoCfuRl\nFhTCfcu+6itSIO5GwLgxXh/uJuPTg2Qq35lswQIDAQABAoIBAAJdaZhI7WjBSfvw\n19jOmGcofFeDuAIKz27N9SYGaW6VI4mLEVhG88ZwcxAiQHNItjYSCuC6Ph+9aBAJ\neG32pcuwx0LQhb89W+vk0964J+peQEeeB43hudXekU9e7jIEDiJSh4qCRzMwYdEE\nfOk0Fd4OQsA89+a+C2fqNYZOLwNkygp0lxGuaM8ZKuDHgkRKZJYGd8V8GltMiVID\n+LT5I4+0PYtT77a1G1GZ6itSb60mcPtFWU/X4I/U1MSvc+jJCzJFP8qEe3caBG1p\n+J1aZAplSAN5IUE2l7/PEyCvxDL9FCbvHmdTrTQ9a8JyHGQJwTWcfk30HHJ71Zi8\nng94DOUCgYEA3VDS9cZRxZsmr7jm+A4mrIoevu/p/2vYbhE9fyxuQG0rC1gK5iRY\nb/Mdtzn5+3oFXZT/e07FfFtERPGkp/yC6FgfNUpjzTDnWW4Hv9JO9UYSQKcn+x8v\n/vlkLbxBRXmkUwnf7WOGeBsjjMznlHdkpctcBBF9O1CmwTWbp762/YMCgYEA2l1f\ndcUwV5aDLtLtRm9Loy1e2G5/iJ8PliJh1JXPFFmRBKyatJ9pUAstJc6q5Jktd958\ndyNBUKu4QBzdhAHOnW7RFt/Vkv2mYaFDNFx9t7Fhqe9pSiDMzcz5qnT69avEm88M\nKFuI0vx/qPUUtTJhBABdwySX+M9KdFjxHIOx/WsCgYBUyeZIqtYhMrO7lsdGOYWv\njKsC079+T773TDuXQVpr7GcVTYG/ciU/npC/5cJUCgeMNs06XI9keULKdxlyElfE\n1B4AuKNLtXSs2m61mskNRu8vPdsfZm9o6/rpWrpW96dw+NOFix+1XBBenRIL20IA\nEs0J8flchCWe1/7uYS6SKQKBgGq9B6OGvwmhbgBeZFNwpbVewSTkZny+25yUs+N5\nUx7sZSG2yWyPG6hfvjLj4c8aPQqB+6800YGAXvEf6vvS8k8sUxJuWXSffkvsyu/2\nYhF/qHCrsXjlrZbPoh67Tcz2qIVM4PF9RNV1TWWmXvfvZ1LQZwSzh4G8ufVDYKCC\nk2d/AoGAQtgUlN8l5psZfrgFoAOkwphvp50sE61Sxww1HO+qVaWlEp3119C6iLwD\nKiKe84SGAFj/UwumtFYz4bzAqBYVcbQZvzZ2MK2nEjaDSI59Br7aQlthEMg2BEXM\nAVN26KwjzDRbQZAPf497+/gH8YuikvJKdzu01rO4riQNYSQALVw=\n-----END RSA PRIVATE KEY-----\n")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"\u0110em file ",Object(a.b)("inlineCode",{parentName:"strong"},"public_key")," \u1edf tr\xean v\xe0 g\u1eafn v\xe0o file ",Object(a.b)("inlineCode",{parentName:"strong"},"authorized_keys")," c\u1ee7a Server.")),Object(a.b)("h3",{id:"setup-authorized-key"},"Setup Authorized Key"),Object(a.b)("p",null,"Dynamic keys. C\u1eadp nh\u1eadt sau..."),Object(a.b)("h3",{id:"c\xe0i-\u0111\u1eb7t-c\xe1c-g\xf3i"},"C\xe0i \u0110\u1eb7t C\xe1c G\xf3i"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"opkg update\nopkg install ttyd prometheus-node-exporter-lua-bmx6 prometheus-node-exporter-lua-bmx7 prometheus-node-exporter-lua-nat_traffic prometheus-node-exporter-lua-netstat prometheus-node-exporter-lua-openwrt prometheus-node-exporter-lua-textfile prometheus-node-exporter-lua-wifi prometheus-node-exporter-lua-wifi_stations autossh\n")),Object(a.b)("h3",{id:"config-ttyd"},"Config TTYD"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"N\u1ed9i dung config:")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"config ttyd\n    option interface '@loopback'\n    option command '/bin/sh -l\n")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Restart v\xe0 enable service")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"/etc/init.d/ttyd restart\n/etc/init.d/ttyd enable\n")),Object(a.b)("h3",{id:"config-autossh"},"Config AutoSSH"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"N\u1ed9i dung config:")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"\nconfig autossh\noption ssh '-N -T\n-o StrictHostKeyChecking=no\n-o ServerAliveInterval=60\n-o ServerAliveCountMax=10\n-R $LOCAL_NAT_IP:2222:localhost:22\n-R $LOCAL_NAT_IP:9100:localhost:9100\n-R $LOCAL_NAT_IP:7681:localhost:7681\nnoaccess@ssh.aps.meganet.com.vn -p 10422'\noption gatetime '0'\noption monitorport '0'\noption poll '600'\noption enabled '1'\n\n")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Restart v\xe0 enable service")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"/etc/init.d/autossh restart\n/etc/init.d/autossh enable\n")),Object(a.b)("h3",{id:"prometheus-lua"},"Prometheus Lua"),Object(a.b)("p",null,"Kh\xf4ng c\xf3 g\xec c\u1ea7n config, tuy nhi\xean c\u1ea7n hi\u1ec3u c\u1ea5u tr\xfac th\u01b0 m\u1ee5c \u0111\u1ec3 ",Object(a.b)("inlineCode",{parentName:"p"},"develop"),"."),Object(a.b)("h2",{id:"access-point-settings"},"ACCESS POINT SETTINGS"),Object(a.b)("h3",{id:"setting-s\xf3ng-wifi"},"Setting S\xf3ng Wifi"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Wifi kh\xf4ng \u0111\u1eb7t m\u1eadt kh\u1ea9u:")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"config wifi-device 'radio0'\n    option type 'mac80211'\n    option channel '36'\n    option hwmode '11a'\n    option path 'pci0000:00/0000:00:00.0'\n    option htmode 'VHT80'\n\nconfig wifi-iface 'default_radio0'\n    option device 'radio0'\n    option network 'lan'\n    option mode 'ap'\n    option encryption 'none'\n    option ssid 'CuongPV'\n\nconfig wifi-device 'radio1'\n    option type 'mac80211'\n    option channel '11'\n    option hwmode '11g'\n    option path 'platform/ahb/18100000.wmac'\n    option htmode 'HT20'\n\nconfig wifi-iface 'default_radio1'\n    option device 'radio1'\n    option network 'lan'\n    option mode 'ap'\n    option encryption 'none'\n    option ssid 'CuongPV'\n")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Wifi \u0111\u1eb7t m\u1eadt kh\u1ea9u:")," "),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"config wifi-device 'radio0'\n    option type 'mac80211'\n    option channel '36'\n    option hwmode '11a'\n    option path 'pci0000:00/0000:00:00.0'\n    option htmode 'VHT80'\n\nconfig wifi-iface 'default_radio0'\n    option device 'radio0'\n    option network 'lan'\n    option mode 'ap'\n    option ssid 'CuongPV'\n    option key '123456789'\n    option encryption 'psk2'\n\nconfig wifi-device 'radio1'\n    option type 'mac80211'\n    option channel '11'\n    option hwmode '11g'\n    option path 'platform/ahb/18100000.wmac'\n    option htmode 'HT20'\n\nconfig wifi-iface 'default_radio1'\n    option device 'radio1'\n    option network 'lan'\n    option mode 'ap'\n    option key '123456789'\n    option ssid 'CuongPV 5GHz'\n    option encryption 'psk2'\n\n")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Roaming nhi\u1ec1u thi\u1ebft b\u1ecb:")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"config wifi-device 'radio0'\n        option type 'mac80211'\n        option channel '36'\n        option hwmode '11a'\n        option path 'pci0000:00/0000:00:00.0'\n        option htmode 'VHT80'\n\nconfig wifi-iface 'default_radio0'\n        option device 'radio0'\n        option network 'lan'  # Client k\u1ebft n\u1ed1i s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ea9y v\xe0o internet lan\n        option mode 'ap'\n        option ssid 'CuongPV'\n        option key '123456789'\n        option encryption 'psk2'\n        option ft_over_ds '1'\n        option ft_psk_generate_local '1'\n        option ieee80211r '1'\n        ### Start Roaming Option ###\n        # N\xean kh\xe1c nhau trong m\u1ed9t khu v\u1ef1c Roaming, t\u01b0\u01a1ng lai s\u1ebd x\u1eed l\xfd v\u1ee5 kh\xe1c nhau sau.\n        # T\u1ea1m th\u1eddi c\u1ea7n roaming th\xec th\xeam option n\xe0y v\xe0o\n        option mobility_domain 'ff00'\n        ### End Roaming Option ###\n\nconfig wifi-device 'radio1'\n        option type 'mac80211'\n        option channel '11'\n        option hwmode '11g'\n        option path 'platform/ahb/18100000.wmac'\n        option htmode 'HT20'\n\nconfig wifi-iface 'default_radio1'\n        option device 'radio1'\n        option network 'lan' # Client k\u1ebft n\u1ed1i s\u1ebd \u0111\u01b0\u1ee3c \u0111\u1ea9y v\xe0o internet lan\n        option mode 'ap'\n        option key '123456789'\n        option ssid 'CuongPV 5GHz'\n        option encryption 'psk2'\n        option ft_over_ds '1'\n        ### Start Roaming Option ###\n        # N\xean kh\xe1c nhau trong m\u1ed9t khu v\u1ef1c Roaming, t\u01b0\u01a1ng lai s\u1ebd x\u1eed l\xfd v\u1ee5 kh\xe1c nhau sau.\n        # T\u1ea1m th\u1eddi c\u1ea7n roaming th\xec th\xeam option n\xe0y v\xe0o\n        option mobility_domain 'ff00' \n        ### End Roaming Option ###\n        option ft_psk_generate_local '1'\n        option ieee80211r '1'\n")),Object(a.b)("h3",{id:"setting-captive-portal"},"Setting Captive Portal"),Object(a.b)("p",null,"C\xf3 2 option \u0111\u1ec3 c\xf3 th\u1ec3 cho ng\u01b0\u1eddi d\xf9ng acces v\xe0o access point"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Can thi\u1ec7p t\u1eeb Server")),Object(a.b)("p",null,"Document"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'root@OpenWrt:/etc/config# ndsctl\nUsage: ndsctl [options] command [arguments]\n\noptions:\n  -s <path>           Path to the socket\n  -h                  Print usage\n\ncommands:\n  status\n    View the status of opennds\n\n  clients\n    Display machine-readable client list\n\n  json  mac|ip|token(optional)\n    Display client list in json format\n    mac|ip|token is optional, if not specified, all clients are listed\n\n  stop\n    Stop the running opennds\n\n  auth mac|ip|token sessiontimeout(minutes) uploadrate(kb/s) downloadrate(kb/s) uploadquota(kB) downloadquota(kB) customstring\n    Authenticate client with specified mac, ip or token\n\n    sessiontimeout sets the session duration. Unlimited if 0, defaults to global setting if null (double quotes).\n    The client will be deauthenticated once the sessiontimout period has passed.\n\n    uploadrate and downloadrate are the maximum allowed data rates. Unlimited if 0, global setting if null ("").\n\n    uploadquota and downloadquota are the maximum volumes of data allowed. Unlimited if 0, global setting if null ("").\n\n    customstring is a custom string that will be passed to BinAuth.\n\n    Example: ndsctl auth 1400 300 1500 500000 1000000 "This is a Custom String"\n\n  deauth mac|ip|token\n    Deauthenticate user with specified mac, ip or token\n\n  block mac\n    Block the given MAC address\n\n  unblock mac\n    Unblock the given MAC address\n\n  allow mac\n    Allow the given MAC address\n\n  unallow mac\n    Unallow the given MAC address\n\n  trust mac\n    Trust the given MAC address\n\n  untrust mac\n    Untrust the given MAC address\n\n  debuglevel n\n    Set debug level to n (0=silent, 1=Normal, 2=Info, 3=debug)\n\n')),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"B\xecnh th\u01b0\u1eddng \u0111\u1ebfn Access Point")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'\n<!DOCTYPE html>\n<html>\n<head>\n<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">\n<meta http-equiv="Pragma" content="no-cache">\n<meta http-equiv="Expires" content="0">\n<meta charset="utf-8">\n<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\n<link rel="shortcut icon" href="/images/splash.jpg" type="image/x-icon">\n<link rel="stylesheet" type="text/css" href="/splash.css">\n\n<title>MegaNet Gateway - Testing by CuongPV</title>\n\n\x3c!--\nContent:\n    openNDS (NDS), by default, serves this splash page (splash.html)\n    when a client device Captive Portal Detection (CPD) process\n    attempts to send a port 80 request to the Internet.\n\n    You may either embed css in this file or use a separate .css file\n    in the same directory as this file, as demonstrated here.\n\n    It should be noted when designing a custom splash page\n    that for security reasons many CPD implementations:\n        Immediately close the browser when the client has authenticated.\n        Prohibit the use of href links.\n        Prohibit downloading of external files\n            (including .css and .js).\n        Prohibit the execution of javascript.\n\nAuthentication:\n    A client is authenticated on submitting an HTTP form, method=get,\n    passing http://192.168.1.1:2050/opennds_auth/, c9907c12, http://nmcheck.gnome.org/ and optionally username and password\n\n    It is also possible to authenticate using an href link to\n    http://192.168.1.1:2050/opennds_auth/?tok=c9907c12&amp;redir=http://nmcheck.gnome.org/ but be aware that many device Captive Portal Detection\n    processes prohibit href links, so this method may not work with\n    all client devices.\n\nAvailable variables:\n    http://192.168.1.1:2050/opennds_auth/\n    http://192.168.1.1:2050/opennds_deny/\n    http://192.168.1.1:2050/opennds_auth/?tok=c9907c12&amp;redir=http://nmcheck.gnome.org/\n    192.168.1.127\n    9c:30:5b:e3:28:5d\n    0\n    0\n    44:d1:fa:59:22:6a\n    MegaNet Gateway - Testing by CuongPV\n    250\n    1\n    http://nmcheck.gnome.org/\n    c9907c12\n    c9907c12\n    5d 20h 5m 25s\n    5.2.0\n    username\n    password\n--\x3e\n\n</head>\n\n<body>\n<div class="offset">\n<med-blue>MegaNet Gateway - Testing by CuongPV</med-blue>\n<div class="insert">\n<big-red>Welcome!</big-red>\n<hr>\n<br>\n<italic-black>For abc access to the Internet, please tap or click Continue.</italic-black>\n<br><br>\n<hr>\n\n<form method="get" action="http://192.168.1.1:2050/opennds_auth/">\n<input type="hidden" name="tok" value="c9907c12">\n<input type="hidden" name="redir" value="http://nmcheck.gnome.org/">\n<input type="submit" value="Continue">\n</form>\n    \n<hr>\n\n<copy-right>\n    <img style="float:left; max-height:5em; height:auto; width:auto" src="/images/splash.jpg" alt="Splash Page: For access to the Internet.">\n    <br><br><br>\n    Copyright &copy; The openNDS Contributors 2004-2020.<br>\n    This software is released under the GNU GPL license.<br>\n    openNDS version 5.2.0\n</copy-right>\n\n\n</div></div>\n</body>\n</html>\n\n')),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"File Backend - Bi\u1ebfn Nguy\xean M\u1eabu")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},'<!DOCTYPE html>\n<html>\n<head>\n<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">\n<meta http-equiv="Pragma" content="no-cache">\n<meta http-equiv="Expires" content="0">\n<meta charset="utf-8">\n<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\n<link rel="shortcut icon" href="/images/splash.jpg" type="image/x-icon">\n<link rel="stylesheet" type="text/css" href="/splash.css">\n\n<title>$gatewayname</title>\n\n\x3c!--\nContent:\n    openNDS (NDS), by default, serves this splash page (splash.html)\n    when a client device Captive Portal Detection (CPD) process\n    attempts to send a port 80 request to the Internet.\n\n    You may either embed css in this file or use a separate .css file\n    in the same directory as this file, as demonstrated here.\n\n    It should be noted when designing a custom splash page\n    that for security reasons many CPD implementations:\n        Immediately close the browser when the client has authenticated.\n        Prohibit the use of href links.\n        Prohibit downloading of external files\n            (including .css and .js).\n        Prohibit the execution of javascript.\n\nAuthentication:\n    A client is authenticated on submitting an HTTP form, method=get,\n    passing $authaction, $tok, $redir and optionally $username and $password\n\n    It is also possible to authenticate using an href link to\n    $authtarget but be aware that many device Captive Portal Detection\n    processes prohibit href links, so this method may not work with\n    all client devices.\n\nAvailable variables:\n    $authaction\n    $denyaction\n    $authtarget\n    $clientip\n    $clientmac\n    $clientupload\n    $clientdownload\n    $gatewaymac\n    $gatewayname\n    $maxclients\n    $nclients\n    $redir\n    $tok\n    $token\n    $uptime\n    $version\n    $username\n    $password\n--\x3e\n\n</head>\n\n<body>\n<div class="offset">\n<med-blue>$gatewayname</med-blue>\n<div class="insert">\n<big-red>Welcome!</big-red>\n<hr>\n<br>\n<italic-black>For abc access to the Internet, please tap or click Continue.</italic-black>\n<br><br>\n<hr>\n\n<form method="get" action="$authaction">\n<input type="hidden" name="tok" value="$tok">\n<input type="hidden" name="redir" value="$redir">\n<input type="submit" value="Continue">\n</form>\n    \n<hr>\n\n<copy-right>\n    <img style="float:left; max-height:5em; height:auto; width:auto" src="/images/splash.jpg" alt="Splash Page: For access to the Internet.">\n    <br><br><br>\n    Copyright &copy; The openNDS Contributors 2004-2020.<br>\n    This software is released under the GNU GPL license.<br>\n    openNDS version $version\n</copy-right>\n\n\n</div></div>\n</body>\n</html>\n\n')),Object(a.b)("p",null,"Y\xeau c\u1ea7u ph\u1ea3i c\xf3 ",Object(a.b)("inlineCode",{parentName:"p"},"token")," \u0111\u1ec3 c\xf3 th\u1ec3 access internet, v\xed d\u1ee5 :"),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"Link: http://192.168.1.1:2050/opennds_auth/?tok=c9907c12&amp;redir=http://nmcheck.gnome.org/\n")),Object(a.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(a.b)("div",{parentName:"div",className:"admonition-heading"},Object(a.b)("h5",{parentName:"div"},Object(a.b)("span",{parentName:"h5",className:"admonition-icon"},Object(a.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(a.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(a.b)("div",{parentName:"div",className:"admonition-content"},Object(a.b)("p",{parentName:"div"},"M\u1ed7i thi\u1ebft b\u1ecb s\u1ebd c\xf3 ri\xeang m\u1ed9t ",Object(a.b)("inlineCode",{parentName:"p"},"redir")," variable kh\xf4ng c\u1ed1 \u0111\u1ecbnh. Tuy nhi\xean, ph\u1ea3i c\xf3 bi\u1ebfn n\xe0y, n\u1ebfu kh\xf4ng thi\u1ebft b\u1ecb s\u1ebd kh\xf4ng th\u1ec3 nh\u1eadn bi\u1ebft Access Point \u0111\xe3 cho ph\xe9p k\u1ebft n\u1ed1i internet hay ch\u01b0a."))),Object(a.b)("h2",{id:"access-point-advanced-setting"},"Access Point Advanced Setting"),Object(a.b)("h3",{id:"network-config"},"Network Config"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"C\u1ea5u h\xecnh network:")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"config interface 'loopback'\n    option ifname 'lo'\n    option proto 'static'\n    option ipaddr '127.0.0.1'\n    option netmask '255.0.0.0'\n\nconfig globals 'globals'\n    option ula_prefix 'fdab:fdc1:a5c7::/48'\n\nconfig interface 'lan'\n    option type 'bridge'\n    option ifname 'eth0.1'\n    option proto 'static'\n    option ipaddr '192.168.1.1'\n    option netmask '255.255.255.0'\n    option ip6assign '60'\n\nconfig interface 'wan'\n    option ifname 'eth0.2'\n    option proto 'dhcp'\n\nconfig interface 'wan6'\n    option ifname 'eth0.2'\n    option proto 'dhcpv6'\n\nconfig switch\n    option name 'switch0'\n    option reset '1'\n    option enable_vlan '1'\n\nconfig switch_vlan\n    option device 'switch0'\n    option vlan '1'\n    option ports '2 0t'\n\nconfig switch_vlan\n    option device 'switch0'\n    option vlan '2'\n    option ports '3 0t'\n")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("inlineCode",{parentName:"p"},"eth0.1")," bridge v\u1edbi interface \u1ea3o t\xean l\xe0 ",Object(a.b)("inlineCode",{parentName:"p"},"lan")," c\xf3 static IP l\xe0 ",Object(a.b)("inlineCode",{parentName:"p"},"192.168.1.1"),".")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("inlineCode",{parentName:"p"},"eth0.2")," \u0111\u01b0\u1ee3c c\u1eafm tr\u1ef1c ti\u1ebfp b\u1eb1ng c\xe1p ethernet v\xe0 \u0111\u01b0\u1ee3c c\u1ea5u h\xecnh IP DHCP."))),Object(a.b)("p",null,"C\xf3 th\u1ec3 t\u1ea1o th\xeam interfaces."),Object(a.b)("h2",{id:"access-point-management"},"ACCESS POINT MANAGEMENT"),Object(a.b)("h3",{id:"\u0111i\u1ec1u-khi\u1ec3n"},"\u0110i\u1ec1u Khi\u1ec3n"),Object(a.b)("p",null,"Truy c\u1eadp domain:"),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},Object(a.b)("a",{parentName:"p",href:"https://ssh.aps.meganet.com.vn/$username/$password/$NAT_IP"},"https://ssh.aps.meganet.com.vn/$username/$password/$NAT_IP"))),Object(a.b)("h3",{id:"gi\xe1m-s\xe1t"},"Gi\xe1m S\xe1t"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"API:")),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},Object(a.b)("a",{parentName:"p",href:"https://prometheus.meganet.com.vn"},"https://prometheus.meganet.com.vn"))),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Grafana UI:")),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},Object(a.b)("a",{parentName:"p",href:"https://grafana.meganet.com.vn"},"https://grafana.meganet.com.vn"))),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"T\u1eaft C\u1ea3nh B\xe1o")),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},Object(a.b)("a",{parentName:"p",href:"https://alertmanager.meganet.com.vn/"},"https://alertmanager.meganet.com.vn/"))),Object(a.b)("h3",{id:"\u0111\u1ebfm-session"},"\u0110\u1ebfm Session"),Object(a.b)("p",null,"Server Prometheus Pull t\u1ea5t c\u1ea3  system log c\u1ee7a t\u1ea5t c\u1ea3 AP v\u1ec1 m\u1ed9t n\u01a1i v\xe0 b\u1eaft \u0111\u1ea7u \u0111\u1ebfm ch\xfang."),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"cat /tmp/ndslog/ndslog.log")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"V\xed d\u1ee5 t\xednh theo l\u01b0\u1ee3t nh\u1eadp th\xf4ng tin:")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"Thu Mar  4 10:06:03 UTC 2021, username=new demo, emailAddress=demo@deme.com, macaddress=9c:30:5b:e3:28:5d, clientzone=LocalZone:wlan1, useragent=Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) coc_coc_browser/93.0.148 Chrome/87.0.4280.148 Safari/537.36\nThu Mar  4 10:06:04 UTC 2021, username=new demo, emailAddress=demo@deme.com, macaddress=9c:30:5b:e3:28:5d, clientzone=LocalZone:wlan1, useragent=Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) coc_coc_browser/93.0.148 Chrome/87.0.4280.148 Safari/537.36\nThu Mar  4 10:06:05 UTC 2021, username=new demo, emailAddress=demo@deme.com, macaddress=9c:30:5b:e3:28:5d, clientzone=LocalZone:wlan1, useragent=Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) coc_coc_browser/93.0.148 Chrome/87.0.4280.148 Safari/537.36\nThu Mar  4 10:12:11 UTC 2021, username=cuongpv, emailAddress=cuongpv@sudosys.com, macaddress=, clientzone=MeshZone:get_client_interface.sh[local_interface]isisisisis, useragent=Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) coc_coc_browser/93.0.148 Chrome/87.0.4280.148 Safari/537.36\nThu Mar  4 10:13:03 UTC 2021, username=sysadmin, emailAddress=cuongpv@sudosys.com, macaddress=9c:30:5b:e3:28:5d, clientzone=LocalZone:wlan1, useragent=Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) coc_coc_browser/93.0.148 Chrome/87.0.4280.148 Safari/537.36\nThu Mar  4 10:13:16 UTC 2021, username=sysadmin, emailAddress=cuongpv@sudosys.com, macaddress=9c:30:5b:e3:28:5d, clientzone=LocalZone:wlan1, useragent=Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) coc_coc_browser/93.0.148 Chrome/87.0.4280.148 Safari/537.36\nThu Mar  4 10:13:27 UTC 2021, username=sysadmin, emailAddress=cuongpv@sudosys.com, macaddress=9c:30:5b:e3:28:5d, clientzone=LocalZone:wlan1, useragent=Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) coc_coc_browser/93.0.148 Chrome/87.0.4280.148 Safari/537.36\n\n")),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"V\xed d\u1ee5 t\xednh theo l\u01b0\u1ee3t click continue:")),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"Wed Mar 10 17:24:34 2021 daemon.info opennds[4935]: Client @ 192.168.1.127 9c:30:5b:e3:28:5d, quotas:\nWed Mar 10 17:25:34 2021 daemon.debug opennds[4935]: Read outgoing traffic for 192.168.1.127: Bytes=1729793\nWed Mar 10 17:25:34 2021 daemon.debug opennds[4935]: 192.168.1.127 - Updated counter.outgoing to 1729793 bytes.  Updated last_updated to 1615397134\nWed Mar 10 17:25:34 2021 daemon.debug opennds[4935]: Read incoming traffic for 192.168.1.127: Bytes=5630151\nWed Mar 10 17:25:34 2021 daemon.debug opennds[4935]: 192.168.1.127 - Updated counter.incoming to 5630151 bytes\nWed Mar 10 17:25:34 2021 daemon.info opennds[4935]: Client @ 192.168.1.127 9c:30:5b:e3:28:5d, quotas:\nWed Mar 10 17:25:34 2021 daemon.debug opennds[4935]: Read outgoing traffic for 192.168.1.127: Bytes=1734448\nWed Mar 10 17:25:34 2021 daemon.debug opennds[4935]: 192.168.1.127 - Updated counter.outgoing to 1734448 bytes.  Updated last_updated to 1615397134\nWed Mar 10 17:25:34 2021 daemon.debug opennds[4935]: Read incoming traffic for 192.168.1.127: Bytes=5631556\nWed Mar 10 17:25:34 2021 daemon.debug opennds[4935]: 192.168.1.127 - Updated counter.incoming to 5631556 bytes\nWed Mar 10 17:26:34 2021 daemon.debug opennds[4935]: Read outgoing traffic for 192.168.1.127: Bytes=1834935\nWed Mar 10 17:26:34 2021 daemon.debug opennds[4935]: 192.168.1.127 - Updated counter.outgoing to 1834935 bytes.  Updated last_updated to 1615397194\nWed Mar 10 17:26:34 2021 daemon.debug opennds[4935]: Read incoming traffic for 192.168.1.127: Bytes=5942562\nWed Mar 10 17:26:34 2021 daemon.debug opennds[4935]: 192.168.1.127 - Updated counter.incoming to 5942562 bytes\nWed Mar 10 17:26:34 2021 daemon.info opennds[4935]: Client @ 192.168.1.127 9c:30:5b:e3:28:5d, quotas:\n")),Object(a.b)("h3",{id:"xem-th\xf4ng-tin-thi\u1ebft-b\u1ecb"},"Xem Th\xf4ng Tin Thi\u1ebft B\u1ecb"),Object(a.b)("p",null,"V\xec hostname s\u1ebd \u0111\u01b0\u1ee3c thay \u0111\u1ed7i, cho n\xean ch\xfang ta c\u1ea7n xem th\xf4ng tin Access Point tr\xean file."),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"cat /tmp/board.json")),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"/tmp/sysinfo/board_name")),Object(a.b)("blockquote",null,Object(a.b)("p",{parentName:"blockquote"},"/tmp/sysinfo/model")),Object(a.b)("h2",{id:"provision-script"},"PROVISION SCRIPT"),Object(a.b)("h3",{id:"setup-command"},"Setup Command"),Object(a.b)("p",null,"L\u1ec7nh c\xe0i \u0111\u1eb7t ph\xeda d\u01b0\u1edbi \u0111\u01b0\u1ee3c \xe1p d\u1ee5ng cho t\u1ea5t c\u1ea3 c\xe1c Access Point c\u1ee7a YunCore, bao g\u1ed3m ",Object(a.b)("inlineCode",{parentName:"p"},"501"),", ",Object(a.b)("inlineCode",{parentName:"p"},"701"),", ",Object(a.b)("inlineCode",{parentName:"p"},"702"),", v.v..."),Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre"},"wget --no-check-certificate  https://raw.githubusercontent.com/khoahoc/openwrt/main/ap_provision.sh -O - -q | sh\n")),Object(a.b)("h3",{id:"github-repository"},"Github Repository"),Object(a.b)("p",null,"Link: ",Object(a.b)("a",{parentName:"p",href:"https://github.com/khoahoc/openwrt"},"https://github.com/khoahoc/openwrt")),Object(a.b)("p",null,Object(a.b)("em",{parentName:"p"},"Script Automation \u0111\u01b0\u1ee3c vi\u1ebft b\u1edfi t\xe1c gi\u1ea3 theo c\u1ea5u tr\xfac document tr\xean. N\u1ebfu Script tr\xean \u0111\u01b0\u1ee3c vi\u1ebft kh\xf4ng \u0111\xfang theo c\u1ea5u tr\xfac tr\xean th\xec Script n\xe0y \u0111\u01b0\u1ee3c xem l\xe0 l\u1ed7i th\u1eddi")))}l.isMDXComponent=!0}}]);